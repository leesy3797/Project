# [프로젝트] OCR과 LLM을 활용한 개인 맞춤 영양정보 제공 End-to-End 서비스

## 1. 프로젝트 설명

- **프로젝트 기간**: 2023.10.08 ~ 2023.10.26

- **목표**: 
    - (서비스) 이미지로 입력받은 가공식품의 영양 정보를 분석하여 개인 맞춤형 건강 정보를 제공하는 End to End 서비스 개발
        - (타겟) 오프라인 소비 중심의 주부 / 온라인 소비 중심의 MZ세대

    - (기술) `[1] OCR 통한 정확한 이미지 인식`과 `[2] AI 기반의 개인화된 건강 정보 제공`
        - (OCR) 모바일로 촬영된 가공식품 패키지의 영양정보 인식 정확도
        - (AI) LLM을 통해 `개인화`된 정보 제공 가능성 

- **개발 툴** : Python
    - Image 전처리 및 OCR : OpenCV, Tesseract OCR, EasyOCR, Paddle OCR
    - LMM : Bard API
    - Dev Enviornment : Jupyter, VsCode
    - Frontend : Streamlit

- **데이터 소스** : 이미지 형태로 획득한 가공식품 영양 정보

- **프로젝트 워크플로우** :

<img src="영양박사를_아세요_Workflow.png" width="500"/>

## **주요 역할 및 기여** : Team Leader

### **(#1) OCR 모델 성능 비교 및 이미지 전처리 실험 (기여도 80%)**

- OCR 모델 성능 비교 및 이미지 전처리 방법 연구
    - Tesseract OCR, EasyOCR, Paddle OCR 등 다양한 OCR 모델 비교 분석
    - 이미지 품질 향상을 위한 OpenCV 기반 전처리 기법 연구 (흑백 처리, Otsu 이진화, 샤프닝)

- EasyOCR Fine tuning을 통한 Text Recognition 성능 향상 시도
    - 한글 OCR 데이터셋 생성 및 LMDB 변환 (가공 식품 관련 689개 단어 기반)
    - EasyOCR 한국어 모델을 기반으로 추가 학습 진행
    - Fine Tuning 결과, 숫자, 단위 인식 성능 향상 확인 => 하지만 학습량 부족으로 전체적인 인식 성능은 하락 => Paddle OCR로 노선 변경
    
### **(#2) Streamlit 기반 Web 서비스 프로토타입 구현 (기여도 50%)**

- Streamlit으로 Web 기반 서비스 PoC(검증) 진행 => 이후 구체화된 서비스로 디벨롭 
- 사용자 정보 입력, OCR 영양 정보 인식 기능 구현
- Bard API를 연동하여 개인 맞춤형 건강 정보 제공 기능 구현
    - 개인 맞춤형 정보 제공을 위한 Bard 프롬프트 엔지니어링 진행
    - 역할 및 목적 부여, 작업 프로세스 정의를 통해 Bard의 Output Structure 통제 및 일관된 출력 결과 보장

## 4. 주요 성과

- 이미지 기반 식품 영양 정보 분석 및 개인 맞춤형 건강 정보 제공 서비스 프로토타입 개발
- OCR 모델 성능 향상 및 프롬프트 엔지니어링을 통한 LMM 활용 가능성 확인
- 프로젝트 결산 1등 (5개 프로젝트 팀 중)

## 5. 프로젝트 회고

- **정량화된 OCR 성능 측정의 부재 및 OCR 성능 개선의 어려움**
    - 4종의 OCR 엔진에 대해 테스트를 진행했지만, 각 모델 간의 성능 차이 및 평가를 위한 객관적인 측정 방식을 고안하지 못함

        - 기존 오픈소스로 공개된 clovaai의 벤치마크 repo의 경우 계량화된 평가지표를 제공하지 않음

        - AI Hub의 [의약품, 화장품 패키징 OCR 데이터]가 가장 프로젝트 환경(포장지 및 성분)에 적합하여 해당 데이터를 활용(평가지표로 F1 score 사용)하고자 했지만, OCR 엔진들과의 입출력 차이 문제를 해결하지 못해 사용 유보

        - CER(Character Error Rate), WER(Word Error Rate) 등의 평가지표가 있지만, 받침, 조사 등 복잡한 문법적 특성을 지닌 한국어 데이터 평가에 어려움이 있어 적용하지 않음

    - 따라서, 대부분의 OCR 모델 간 퍼포먼스 비교는 육안을 통한 정성적인 측정으로 이루어졌음

    - 사람이 하나하나 케이스별로 검토를 진행하다보니, 시간이 많이 소요되고, 면밀한 검토가 어려우며, 많은 케이스에 대한 검토를 진행하지 못함

- **Bard API의 불안전성과 한계점**
    - Bard API를 활용하여 개인 맞춤형 건강 정보를 제공하는 가능성을 확인했지만, API 사용의 불안정성(분당 호출 수 제한, 임시 쿠키값 사용으로 쿠키값이 갱신되면 매뉴얼하게 수정을 해줘야 되는 문제)과 제한적인 기능으로 인해 안정적인 Output 출력과 신뢰성 있는 답변 결과물을 기대하기 어려웠음
    - GPT-3.5와 같은 상용 LLM API로 교체하여, 더 고품질의 답변 결과를 LMM 모델 학습 및 프롬프트 엔지니어링을 통해 LMM 활용도를 높일 필요가 있음

- **서비스 차원의 개선 필요성**
    - 짧은 프로젝트 기간으로 대부분의 작업이 기술적 구현에 초점이 맞춰지다보니, 서비스 자체의 퀄리티가 부족한 감이 있음

    - 더 세밀한 타겟 사용자 설정을 통해 제공하고자 하는 개인화된 서비스에 대한 구체화된 정의가 필요할 것으로 생각됨
        - (기존) 알레르기 또는 섭취 주의 정보, 권장 섭취량 대비 영양성분 비율, 운동 별 칼로리 소모량

    - 서비스 내 와우 모멘트가 될 만한 포인트가 없음. 부족한 영양분을 보완할 영양제 추천이라든가, 같은 상품군에서 좀 더 건강한(낮은 칼로리, 높은 건강한 성분) 대체 상품에 대한 추천, 하루치 섭취 식품을 기반으로 한 제안 등 이 서비스를 사용해야 할 필요성을 느끼게 할 만한 피처 추가가 필요할 것임


## 6. 프로젝트 결과물
- Nutrition_Advisor 디렉토리
- [최종 발표 자료](영양박사를_아세요_최종발표.pdf)
